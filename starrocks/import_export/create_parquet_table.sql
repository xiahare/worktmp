DROP TABLE IF EXISTS db_log_public.dataset_fgt_traffic_parque;
CREATE EXTERNAL TABLE IF NOT EXISTS db_log_public.dataset_fgt_traffic_parquet (
  itime TIMESTAMP ,
  adomid BIGINT ,
  devid STRING ,
  vd STRING ,
  id BIGINT ,
  dtime TIMESTAMP ,
  euid INT,
  epid INT,
  dsteuid INT,
  dstepid INT,
  logflag INT,
  logver INT,
  sfsid BIGINT,
  logid STRING,
  type STRING,
  subtype STRING,
  `level` STRING,    
  action STRING,
  utmaction STRING,
  policyid BIGINT,
  sessionid BIGINT,
  srcip STRING,
  dstip STRING,
  tranip STRING,
  transip STRING,
  srcport INT,
  dstport INT,
  tranport INT,
  transport INT,
  trandisp STRING,
  duration INT,
  proto SMALLINT,
  vrf TINYINT,
  slot SMALLINT,
  sentbyte BIGINT,
  rcvdbyte BIGINT,
  sentdelta BIGINT,
  rcvddelta BIGINT,
  sentpkt BIGINT,
  rcvdpkt BIGINT,
  `user` STRING,     
  unauthuser STRING,
  dstunauthuser STRING,
  srcname STRING,
  dstname STRING,
  `group` STRING,     
  service STRING,
  app STRING,
  appcat STRING,
  fctuid STRING,
  srcintfrole STRING,
  dstintfrole STRING,
  srcserver TINYINT,
  dstserver TINYINT,
  appid INT,
  appact STRING,
  apprisk STRING,
  wanoptapptype STRING,
  policytype STRING,
  centralnatid BIGINT,
  channel BIGINT,
  vwpvlanid BIGINT,
  shapingpolicyid BIGINT,
  eventtime TIMESTAMP,
  vwlid BIGINT,
  shaperdropsentbyte BIGINT,
  shaperdroprcvdbyte BIGINT,
  shaperperipdropbyte BIGINT,
  wanin BIGINT,
  wanout BIGINT,
  lanin BIGINT,
  lanout BIGINT,
  crscore BIGINT,
  craction BIGINT,
  crlevel STRING,
  countapp INT,
  countav INT,
  countdlp INT,
  countemail INT,
  countips INT,
  countweb INT,
  countwaf INT,
  countssl INT,
  countssh INT,
  countdns INT,
  srcuuid STRING,
  dstuuid STRING,
  poluuid STRING,
  srcmac STRING,
  mastersrcmac STRING,
  dstmac STRING,
  masterdstmac STRING,
  srchwvendor STRING,
  srchwversion STRING,
  srcfamily STRING,
  srcswversion STRING,
  dsthwvendor STRING,
  dsthwversion STRING,
  dstfamily STRING,
  dstswversion STRING,
  devtype STRING,
  devcategory STRING,
  dstdevtype STRING,
  dstdevcategory STRING,
  osname STRING,
  osversion STRING,
  dstosname STRING,
  dstosversion STRING,
  srccountry STRING,
  dstcountry STRING,
  srcssid STRING,
  dstssid STRING,
  srcintf STRING,
  dstintf STRING,
  srcinetsvc STRING,
  dstinetsvc STRING,
  unauthusersource STRING,
  dstunauthusersource STRING,
  authserver STRING,
  applist STRING,
  vpn STRING,
  vpntype STRING,
  radioband STRING,
  policyname STRING,
  policymode STRING,
  sslaction STRING,
  url STRING,
  agent STRING,
  `comment` STRING,       
  ap STRING,
  apsn STRING,
  vwlservice STRING,
  vwlquality STRING,
  collectedemail STRING,
  dstcollectedemail STRING,
  shapersentname STRING,
  shaperrcvdname STRING,
  shaperperipname STRING,
  msg STRING,
  custom_field1 STRING,
  utmevent STRING,
  utmsubtype STRING,
  sender STRING,
  recipient STRING,
  virus STRING,
  attack STRING,
  hostname STRING,
  catdesc STRING,
  dlpsensor STRING,
  utmref STRING,
  tdinfoid BIGINT,
  dstowner STRING,
  tdtype STRING,
  tdscantime INT,
  tdthreattype INT,
  tdthreatname INT,
  tdwfcate INT,
  threatwgts STRING,
  threatcnts STRING,
  threatlvls STRING,
  saasinfo STRING,
  ebtime STRING,
  clouduser STRING,
  threats STRING,
  threattyps STRING,
  apps STRING,
  countff INT,
  identifier INT,
  securityid BIGINT,
  securityact STRING,
  tz STRING,
  srcdomain STRING,
  counticap INT,
  dstregion STRING,
  srcregion STRING,
  dstcity STRING,
  srccity STRING,
  `signal` INT,     
  snr INT,
  dstauthserver STRING,
  dstgroup STRING,
  dstuser STRING,
  tunnelid BIGINT,
  vwlname STRING,
  srcthreatfeed STRING,
  dstthreatfeed STRING,
  psrcport INT,
  pdstport INT,
  srcreputation BIGINT,
  dstreputation BIGINT,
  vip STRING,
  accessproxy STRING,
  gatewayid BIGINT,
  clientdeviceid STRING,
  clientdeviceowner STRING,
  clientdevicetags STRING,
  httpmethod STRING,
  referralurl STRING,
  saasname STRING,
  srcmacvendor STRING,
  shapingpolicyname STRING,
  accessctrl STRING,
  countcifs INT,
  proxyapptype STRING,
  clientdevicemanageable STRING,
  emsconnection STRING,
  srcremote STRING,
  replydstintf STRING,
  replysrcintf STRING,
  vsn STRING,
  countsctpf INT,
  realserverid INT,
  clientdeviceems STRING,
  clientcert STRING,
  countcasb INT,
  durationdelta BIGINT,
  countvpatch INT,
  sentpktdelta BIGINT,
  rcvdpktdelta BIGINT,
  fwdsrv STRING
)
STORED AS PARQUET
LOCATION '/dataset/parquet/traffic/'
TBLPROPERTIES ('parquet.compression'='SNAPPY');