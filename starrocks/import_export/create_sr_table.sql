
DROP TABLE IF EXISTS db_log_public.large_fgt_traffic;
CREATE TABLE db_log_public.large_fgt_traffic (
  itime DATETIME NOT NULL,
  adomid BIGINT NOT NULL,
  devid VARCHAR(64) NOT NULL,
  vd VARCHAR(64) NOT NULL,
  id BIGINT NOT NULL,
  dtime DATETIME NOT NULL,
  euid INT,
  epid INT,
  dsteuid INT,
  dstepid INT,
  logflag INT,
  logver INT,
  sfsid BIGINT,
  logid VARCHAR(60000),
  type VARCHAR(60000),
  subtype VARCHAR(60000),
  `level` VARCHAR(60000),
  action VARCHAR(60000),
  utmaction VARCHAR(60000),
  policyid BIGINT,
  sessionid BIGINT,
  srcip VARCHAR(60000),
  dstip VARCHAR(60000),
  tranip VARCHAR(60000),
  transip VARCHAR(60000),
  srcport INT,
  dstport INT,
  tranport INT,
  transport INT,
  trandisp VARCHAR(60000),
  duration INT,
  proto SMALLINT,
  vrf TINYINT,
  slot SMALLINT,
  sentbyte BIGINT,
  rcvdbyte BIGINT,
  sentdelta BIGINT,
  rcvddelta BIGINT,
  sentpkt BIGINT,
  rcvdpkt BIGINT,
  `user` VARCHAR(60000),
  unauthuser VARCHAR(60000),
  dstunauthuser VARCHAR(60000),
  srcname VARCHAR(60000),
  dstname VARCHAR(60000),
  `group` VARCHAR(60000),
  service VARCHAR(60000),
  app VARCHAR(60000),
  appcat VARCHAR(60000),
  fctuid VARCHAR(60000),
  srcintfrole VARCHAR(60000),
  dstintfrole VARCHAR(60000),
  srcserver TINYINT,
  dstserver TINYINT,
  appid INT,
  appact VARCHAR(60000),
  apprisk VARCHAR(60000),
  wanoptapptype VARCHAR(60000),
  policytype VARCHAR(60000),
  centralnatid BIGINT,
  channel BIGINT,
  vwpvlanid BIGINT,
  shapingpolicyid BIGINT,
  eventtime DATETIME,
  vwlid BIGINT,
  shaperdropsentbyte BIGINT,
  shaperdroprcvdbyte BIGINT,
  shaperperipdropbyte BIGINT,
  wanin BIGINT,
  wanout BIGINT,
  lanin BIGINT,
  lanout BIGINT,
  crscore BIGINT,
  craction BIGINT,
  crlevel VARCHAR(60000),
  countapp INT,
  countav INT,
  countdlp INT,
  countemail INT,
  countips INT,
  countweb INT,
  countwaf INT,
  countssl INT,
  countssh INT,
  countdns INT,
  srcuuid VARCHAR(60000),
  dstuuid VARCHAR(60000),
  poluuid VARCHAR(60000),
  srcmac VARCHAR(60000),
  mastersrcmac VARCHAR(60000),
  dstmac VARCHAR(60000),
  masterdstmac VARCHAR(60000),
  srchwvendor VARCHAR(60000),
  srchwversion VARCHAR(60000),
  srcfamily VARCHAR(60000),
  srcswversion VARCHAR(60000),
  dsthwvendor VARCHAR(60000),
  dsthwversion VARCHAR(60000),
  dstfamily VARCHAR(60000),
  dstswversion VARCHAR(60000),
  devtype VARCHAR(60000),
  devcategory VARCHAR(60000),
  dstdevtype VARCHAR(60000),
  dstdevcategory VARCHAR(60000),
  osname VARCHAR(60000),
  osversion VARCHAR(60000),
  dstosname VARCHAR(60000),
  dstosversion VARCHAR(60000),
  srccountry VARCHAR(60000),
  dstcountry VARCHAR(60000),
  srcssid VARCHAR(60000),
  dstssid VARCHAR(60000),
  srcintf VARCHAR(60000),
  dstintf VARCHAR(60000),
  srcinetsvc VARCHAR(60000),
  dstinetsvc VARCHAR(60000),
  unauthusersource VARCHAR(60000),
  dstunauthusersource VARCHAR(60000),
  authserver VARCHAR(60000),
  applist VARCHAR(60000),
  vpn VARCHAR(60000),
  vpntype VARCHAR(60000),
  radioband VARCHAR(60000),
  policyname VARCHAR(60000),
  policymode VARCHAR(60000),
  sslaction VARCHAR(60000),
  url VARCHAR(60000),
  agent VARCHAR(60000),
  `comment` VARCHAR(60000),
  ap VARCHAR(60000),
  apsn VARCHAR(60000),
  vwlservice VARCHAR(60000),
  vwlquality VARCHAR(60000),
  collectedemail VARCHAR(60000),
  dstcollectedemail VARCHAR(60000),
  shapersentname VARCHAR(60000),
  shaperrcvdname VARCHAR(60000),
  shaperperipname VARCHAR(60000),
  msg VARCHAR(60000),
  custom_field1 VARCHAR(60000),
  utmevent VARCHAR(60000),
  utmsubtype VARCHAR(60000),
  sender VARCHAR(60000),
  recipient VARCHAR(60000),
  virus VARCHAR(60000),
  attack VARCHAR(60000),
  hostname VARCHAR(60000),
  catdesc VARCHAR(60000),
  dlpsensor VARCHAR(60000),
  utmref VARCHAR(60000),
  tdinfoid BIGINT,
  dstowner VARCHAR(60000),
  tdtype VARCHAR(60000),
  tdscantime INT,
  tdthreattype INT,
  tdthreatname INT,
  tdwfcate INT,
  threatwgts VARCHAR(60000),
  threatcnts VARCHAR(60000),
  threatlvls VARCHAR(60000),
  saasinfo VARCHAR(60000),
  ebtime VARCHAR(60000),
  clouduser VARCHAR(60000),
  threats VARCHAR(60000),
  threattyps VARCHAR(60000),
  apps VARCHAR(60000),
  countff INT,
  identifier INT,
  securityid BIGINT,
  securityact VARCHAR(60000),
  tz VARCHAR(60000),
  srcdomain VARCHAR(60000),
  counticap INT,
  dstregion VARCHAR(60000),
  srcregion VARCHAR(60000),
  dstcity VARCHAR(60000),
  srccity VARCHAR(60000),
  `signal` INT,
  snr INT,
  dstauthserver VARCHAR(60000),
  dstgroup VARCHAR(60000),
  dstuser VARCHAR(60000),
  tunnelid BIGINT,
  vwlname VARCHAR(60000),
  srcthreatfeed VARCHAR(60000),
  dstthreatfeed VARCHAR(60000),
  psrcport INT,
  pdstport INT,
  srcreputation BIGINT,
  dstreputation BIGINT,
  vip VARCHAR(60000),
  accessproxy VARCHAR(60000),
  gatewayid BIGINT,
  clientdeviceid VARCHAR(60000),
  clientdeviceowner VARCHAR(60000),
  clientdevicetags VARCHAR(60000),
  httpmethod VARCHAR(60000),
  referralurl VARCHAR(60000),
  saasname VARCHAR(60000),
  srcmacvendor VARCHAR(60000),
  shapingpolicyname VARCHAR(60000),
  accessctrl VARCHAR(60000),
  countcifs INT,
  proxyapptype VARCHAR(60000),
  clientdevicemanageable VARCHAR(60000),
  emsconnection VARCHAR(60000),
  srcremote VARCHAR(60000),
  replydstintf VARCHAR(60000),
  replysrcintf VARCHAR(60000),
  vsn VARCHAR(60000),
  countsctpf INT,
  realserverid INT,
  clientdeviceems VARCHAR(60000),
  clientcert VARCHAR(60000),
  countcasb INT,
  durationdelta BIGINT,
  countvpatch INT,
  sentpktdelta BIGINT,
  rcvdpktdelta BIGINT,
  fwdsrv VARCHAR(60000)
) ENGINE=OLAP
DUPLICATE KEY(itime, adomid, devid, vd, id)
PARTITION BY RANGE(itime) (
  START ("2025-01-01") END ("2025-02-01") EVERY (INTERVAL 1 DAY)
)
DISTRIBUTED BY HASH(adomid, id) BUCKETS 50
PROPERTIES (
  "replication_num" = "3"
);